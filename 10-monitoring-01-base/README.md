# Домашнее задание к занятию "10.01. Зачем и что нужно мониторить"

## Обязательные задания

1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя
платформу для вычислений с выдачей текстовых отчетов, которые сохраняются на диск. Взаимодействие с платформой
осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы
выведите в мониторинг и почему?

```
1 Нагрузка СPU, загрузка (место) Накопители (Диски), Загрузка памяти память хоста на котором запущено приложение
2 Нагрузка СPU, загрузка (место) Накопители (Диски), Загрузка памяти память хоста на котором запущено БД, если это отдельный хост
3 Время запси/чтения диска, покажет доступность дисковой подсистемы
4 Доступность страницы приложения, открытие страницы  - с кодом 200, если ПО с WEBUI то проверку осуществлять на удачнотсть авторизации (при отсутсвии штатного Healthcheck)
5 Если ПО работает в виде службы - проверку работосопособности служьбы, или альетрнативно проверка запущенного процесса
6 Количество открытых соединение с хостом /сервисом
7 Проверка доступности БД (connect до БД)
8 Проверка времени выполнения запроса если такое доступно, если в БД пишутся данные регулярно с указанием времени записи, то можно проверять время поcледней записи/изменения и оценить активность ПО
9 Мониторинг БД на предмет долгоработающих блокировок
10 Если используются регламеннтые задачи/джобы - проверка их выполнения(успешного завершения) по регламенту
11 Проверка Учетных записей на предмет блокировки - работоспособность ТУЗ
12 Проверка доступности сетевого соедниение между хоставми работающими в связске с сервисом (приложение и БД в данном случае)
13 Нагрузка на сетвой интерфейс.
14 Доступность порта до хоста (простые telnet и ping как минимум)
```

2. Менеджер продукта посмотрев на ваши метрики сказал, что ему непонятно что такое RAM/inodes/CPUla. Также он сказал,
что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы
можете ему предложить?

```
CPU - нагруженность(задержки на комманд процесса) процессора (нагрузка на приложение)
inodes - загруженность файлово системы (нагрузка ПО на формирование отчетов:кол-во отчетов)
RAM -  загруженность оперативной памяти

Предолжу заключить соглашение по дополнительным метрикам (в дополнение можно и SLA к ним)
Время формирования отчета, можно разбить на несколько метрик : среднее время, а так же минимальное и максимальное время
Количество ошибок при формировании отчетов, точнее количество отчетов с ошибокй, завершившихся неудачно (не испольненных)
Доступность приложения в разрезе времени (отклик на работоспособность)

```

3. Вашей DevOps команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики в свою
очередь хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации,
чтобы разработчики получали ошибки приложения?

```
вариант 1 : Класcические текстовые логи хранить на сетевом ресурсе (расшарить ресурс) и давать доступ кому необходимо (естественно на чтение)
Вариант 2 : Использовать систему сбора логов (стэк ELK, или clickhouse/vector), предоставить доступ в КИбану иди lighthouse для разработчиков на соответсвующие пространства
           
```
3. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA=99% по http кодам ответов.
Вычисляете этот параметр по следующей формуле: summ_2xx_requests/summ_all_requests. Данный параметр не поднимается выше
70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

```
Коды ответов 300-399 - редректы, так же нужно учитывать как успешные, т.к. они не являются по своей сути ошибками, особенно если это в сервисе имеет место быть
Так же коды 100-199 - тинформационные сообщения, которые в свою очередь не являются ошибками.
код 2** - разумно использовать как проверку доступности сервиса, а не едиснтвенный признак работоспособности.
```

## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Вы устроились на работу в стартап. На данный момент у вас нет возможности развернуть полноценную систему
мониторинга, и вы решили самостоятельно написать простой python3-скрипт для сбора основных метрик сервера. Вы, как
опытный системный-администратор, знаете, что системная информация сервера лежит в директории `/proc`.
Также, вы знаете, что в системе Linux есть  планировщик задач cron, который может запускать задачи по расписанию.

Суммировав все, вы спроектировали приложение, которое:
- является python3 скриптом
- собирает метрики из папки `/proc`
- складывает метрики в файл 'YY-MM-DD-awesome-monitoring.log' в директорию /var/log
(YY - год, MM - месяц, DD - день)
- каждый сбор метрик складывается в виде json-строки, в виде:
  + timestamp (временная метка, int, unixtimestamp)
  + metric_1 (метрика 1)
  + metric_2 (метрика 2)

     ...

  + metric_N (метрика N)

- сбор метрик происходит каждую 1 минуту по cron-расписанию

Для успешного выполнения задания нужно привести:

а) работающий код python3-скрипта,

б) конфигурацию cron-расписания,

в) пример верно сформированного 'YY-MM-DD-awesome-monitoring.log', имеющий не менее 5 записей,

P.S.: количество собираемых метрик должно быть не менее 4-х.
P.P.S.: по желанию можно себя не ограничивать только сбором метрик из `/proc`.

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
